<!-- task-list内のカードを生成するJS部分だけ抜粋 -->
<script>
  const taskList = document.getElementById("task-list");
  const form = document.getElementById("task-form");
  const titleInput = document.getElementById("task-title");
  const detailInput = document.getElementById("task-detail");

  function saveTasks() {
    const tasks = [];
    taskList.querySelectorAll(".card").forEach(card => {
      const title = card.querySelector("h3").textContent;
      const detail = card.querySelector("p").textContent;
      const checked = card.querySelector("input[type='checkbox']").checked;
      tasks.push({ title, detail, checked });
    });
    localStorage.setItem("dayxTasks", JSON.stringify(tasks));
  }

  function renderTask(title, detail, checked = false) {
    const card = document.createElement("div");
    card.className = "card";
    if (checked) card.classList.add("checked");

    const h3 = document.createElement("h3");
    h3.textContent = title;

    const p = document.createElement("p");
    p.textContent = detail;

    const controls = document.createElement("div");
    controls.className = "card-controls";
    controls.style.display = "flex";
    controls.style.alignItems = "center";
    controls.style.gap = "0.5em";
    controls.style.marginTop = "0.6em";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.checked = checked;
    checkbox.style.width = "18px";
    checkbox.style.height = "18px";
    checkbox.style.marginRight = "0.3em";
    checkbox.addEventListener("change", () => {
      card.classList.toggle("checked", checkbox.checked);
      saveTasks();
    });

    const editBtn = document.createElement("button");
    editBtn.textContent = "編集";
    editBtn.style.padding = "0.3em 0.7em";
    editBtn.style.borderRadius = "6px";
    editBtn.style.fontSize = "0.8rem";
    editBtn.style.backgroundColor = "#444";
    editBtn.style.color = "white";
    editBtn.style.border = "none";
    editBtn.onclick = () => {
      const newTitle = prompt("タイトルを編集：", h3.textContent);
      const newDetail = prompt("詳細を編集：", p.textContent);
      if (newTitle !== null) h3.textContent = newTitle;
      if (newDetail !== null) p.textContent = newDetail;
      saveTasks();
    };

    const delBtn = document.createElement("button");
    delBtn.textContent = "削除";
    delBtn.style.padding = "0.3em 0.7em";
    delBtn.style.borderRadius = "6px";
    delBtn.style.fontSize = "0.8rem";
    delBtn.style.backgroundColor = "#444";
    delBtn.style.color = "white";
    delBtn.style.border = "none";
    delBtn.onclick = () => {
      if (confirm("このカードを削除しますか？")) {
        card.remove();
        saveTasks();
      }
    };

    controls.appendChild(checkbox);
    controls.appendChild(editBtn);
    controls.appendChild(delBtn);

    card.appendChild(h3);
    card.appendChild(p);
    card.appendChild(controls);
    taskList.appendChild(card);
  }

  form.addEventListener("submit", e => {
    e.preventDefault();
    const title = titleInput.value.trim();
    const detail = detailInput.value.trim();
    if (!title) return;
    renderTask(title, detail);
    saveTasks();
    form.reset();
  });

  const saved = JSON.parse(localStorage.getItem("dayxTasks") || "[]");
  saved.forEach(task => renderTask(task.title, task.detail, task.checked));
</script>